***********************************************************
ヘッドカメラをwebカメラとして使ってみよう
***********************************************************

AKARIのヘッドカメラとして採用しているOAK-D Liteは、通常のwebカメラとは使い方が異なりますが、通常のカメラのように **UVC** 規格でのストリーミングを行うこともできます。

UVCとはUSB Video Classの略で、主にUSBカメラの通信方法に関する規格です。

これを行うには、UVCに偽装するためのアプリを立ち上げる必要があります。

.. note::

   AKARIのソフトはpoetryというpythonの仮想環境マネージャーを用いてセットアップされています。

   AKARIのアプリを実行する際は、最初にこの仮想環境へ移動する必要があります。

   akari_main直下へ移動し、 `poetry shell` を実行して仮想環境を立ち上げます。

      .. code-block:: bash

         $ cd akari_main
         $ poetry shell

===========================================================
アプリのディレクトリへの移動
===========================================================

最初にUVCアプリの保存先のディレクトリへ移動しましょう。

   .. code-block:: bash

      $ cd src/depthai_uvc

===========================================================
UVCアプリの実行
===========================================================

UVCアプリを立ち上げます。depthai_uvcでは、RGBとステレオdepthの2つをストリーミングすることができます。

RGBの場合は下記を実行します。

   .. code-block:: bash

      $ python3 depthai_uvc_rgb.py

ステレオdepthの場合は下記を実行します。

   .. code-block:: bash

      $ python3 depthai_uvc_depth.py

このアプリを起動している間は、OAK-D Liteの映像が `/dev/video20` に割り当てられ、ストリーミングされます。

コマンドライン上でCtrl+Cを押すと終了します。

=============================
映像の確認
=============================

例えば、Ubuntu標準で入っているカメラ映像の撮影アプリ `cheese` を起動して確かめてみましょう。

depthai_uvcを起動したまま、新しいターミナルを立ち上げて、cheeseを起動します。

   .. code-block:: bash

      $ cheese

cheeseのウインドウが起動し、OAK-Dの映像が確認できるようになったと思います。

このように、depthai_uvcを起動しておくことで、一般的なwebカメラの映像を用いるアプリやプログラムでもOAK-D Liteの映像を使うことができます。