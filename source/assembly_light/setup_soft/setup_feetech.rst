***********************************************************
Feetechサーボのセットアップ
***********************************************************

AKARI Lightのヘッドのパン、チルト動作に使用しているFeetechサーボ(STS3215)の設定を行います。

===========================================================
必要なもの
===========================================================

* AKARI Light(:doc:`setup_ansible` 実施済み)
* キーボード
* マウス
* ディスプレイ

===========================================================
仮想環境の作成
===========================================================
| まずは、Feetechサーボの設定を行うための仮想環境を作成します。
| ターミナルを開いて、下記コマンドを実行します。
| これにより、仮想環境を作成、有効化し、必要なライブラリをインストールします。

.. code-block:: bash

    cd ~/akari_software/setup/feetech
    python3 -m venv venv
    . venv/bin/activate
    pip install -r requirements.txt

===========================================================
Feetechサーボ1のIDの仮変更
===========================================================

| 次にボディーに接続されているFeetechサーボ1のIDを仮変更します。
| **必ずヘッドに接続されているFeetechサーボへの配線を外した状態のままで実施してください。**
| ターミナルを開いて、下記コマンドを実行します。

.. code-block:: bash

    python3 1_temp_change_id.py

| このスクリプトは、Feetechサーボ1のIDを100に仮変更します。

===========================================================
Feetechサーボ2の接続
===========================================================

| ここで、ヘッドに接続されているFeetechサーボ2の配線を行います。
| 接続されていない配線を、ヘッド部のSTS3215に接続してください。

.. image:: ../../images/assembly_light/setup_feetech/feetech_01.jpg
    :width: 600px

===========================================================
FeetechサーボのIDの変更
===========================================================

| この状態で、Feetechサーボ1,2のIDを本変更します。
| 下記コマンドを実行します。

.. code-block:: bash

    python3 2_change_id.py

| このスクリプトは、Feetechサーボ1のIDを1、Feetechサーボ2のIDを2に変更します。

===========================================================
Feetechサーボのbaudrateの変更
===========================================================

| 次にFeetechサーボ1,2のbaudrateを500000に変更します。
| 下記コマンドを実行します。

.. code-block:: bash

    python3 3_change_baudrate.py

===========================================================
Feetechサーボの0位置の設定
===========================================================

| Feetechサーボの0位置の設定を行います。

1. ヘッドを手動で動かし、上下左右共に正面方向を向くようにします。

.. image:: ../../images/assembly_light/setup_feetech/feetech_02.jpg
    :width: 600px

2. 下記コマンドを実行し、Pan(左右方向)の現在位置を0位置として保存します。

.. code-block:: bash

    python3 set_0pos.py --id 1

3. 下記コマンドを実行し、Tilt(上下方向)の現在位置を0位置として保存します。

.. code-block:: bash

    python3 set_0pos.py --id 2

4. 下記コマンドを実行し、Feetechサーボ1,2を0位置に移動させます。

.. code-block:: bash

    python3 move_0pos.py

| 両方のサーボの0位置が正面向きになっていることが確認できればOKです。

| 以上でFeetechサーボのセットアップは完了です。
| 次はakari_software直下にアプリケーションを実行するための仮想実行環境を構築します。
|

:doc:`setup_env` へ進む

:doc:`setup_ansible` へ戻る

