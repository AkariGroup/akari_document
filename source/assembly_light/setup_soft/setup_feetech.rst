***********************************************************
Feetechサーボのセットアップ
***********************************************************

AKARI Lightのヘッドのパン、チルト動作に使用しているFeetechサーボ(STS3215)の設定を行います。

===========================================================
必要なもの
===========================================================

* AKARI Light(:doc:`setup_ansible` 実施済み)
* キーボード
* マウス
* ディスプレイ

===========================================================
仮想環境の作成
===========================================================
| まずは、Feetechサーボの設定を行うための仮想環境を作成します。
| ターミナルを開いて、下記コマンドを実行します。
| これにより、仮想環境を作成、有効化し、必要なライブラリをインストールします。

.. code-block:: bash

    cd ~/akari_software/setup/feetech
    python3 -m venv venv
    . venv/bin/activate
    pip install -r requirements.txt

===========================================================
Feetechサーボ1のIDの仮変更
===========================================================

| 次にボディーに接続されているFeetechサーボ1のIDを仮変更します。
| **必ずヘッドに接続されているFeetechサーボへの配線を外した状態のままで実施してください。**
| ターミナルを開いて、下記コマンドを実行します。

.. code-block:: bash

    python3 1_temp_change_id.py

| このスクリプトは、Feetechサーボ1のIDを100に仮変更します。

===========================================================
Feetechサーボ2の接続
===========================================================

| ここで、ヘッドに接続されているFeetechサーボ2の配線を行います。
| 接続されていない配線を、ヘッド部のSTS3215に接続してください。

===========================================================
FeetechサーボのID, baudrateの変更
===========================================================

| この状態で、Feetechサーボ1,2のIDを本変更し、baudrateを500000に変更します。
| 下記コマンドを実行します。

.. code-block:: bash

    python3 2_change_id.py

| このスクリプトは、Feetechサーボ1のIDを1、Feetechサーボ2のIDを2に変更後、baudrateを500000に変更します。。

===========================================================
Feetechサーボの0位置の確認
===========================================================

| Feetechサーボの0位置の確認を行います。

1. 下記コマンドを実行し、Feetechサーボ1,2を0位置に移動させます。

.. code-block:: bash

    python3 move_0pos.py

2. 1. で0位置がパン、チルト共に正面向きになっているのが正しい状態です。
| 0位置が正面向きでない場合は、手動で正面に向けます。

3. 正面向きになったら、下記コマンドを実行し、現在位置を0位置として保存します。

.. code-block:: bash

    python3 set_0pos.py

4. もう一度下記コマンドを実行し、Feetechサーボ1,2を0位置に移動させます。

.. code-block:: bash

    python3 move_0pos.py

| 以上でFeetechサーボのセットアップは完了です。
| 次はakari_software直下にアプリケーションを実行するための仮想実行環境を構築します。
|

:doc:`setup_env` へ進む

:doc:`setup_ansible` へ戻る

